<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>依谷网-专注于绿色生态农产品宅生活电商</title>
    <style type="text/css" rel="stylesheet">
    </style>
    <link rel="stylesheet" href="css/通用样式.css">
    <link rel="stylesheet" href="css/头部样式.css">
    <link rel="stylesheet" href="css/菜单样式.css">
    <link rel="stylesheet" href="css/尾部样式.css">
    <link rel="stylesheet" href="css/购物车.css">
</head>
<body>
    <div class="header">
        <div class="headerBox">
            <div id="welcome">
                <span>欢迎光临依谷网!</span><a href="#">&nbsp&nbsp&nbsp&nbsp&nbsp收藏依谷网</a>
            </div>
            <div class="user">
                <a href="register.html" class="user_go">免费注册</a>|
                <a href="login.html" class="user_go">登录</a>|
                <a href="#" class="user_go">购物车</a>|
                <span><img src="img/icon-erwm.png" alt="">关注购物网<img src="img/wx.jpg" alt=""></span>
                <a href="#1" class="user_Licence">食品经营许可</a>|
            </div>
        </div>
    </div>
    <div class="searchTopBox">
        <div>
            <a href="main.html" id="logo"><img src="img/logo.png" alt=""></a>
            <div class="searchBox">
                <input type="text" id="search" placeholder="大闸蟹特惠">
                <input type="button" value="搜索" id="searchButton">
                </p>
            </div>
            <div class="shopBox">
                <span class="shopNum">0</span><i></i><span>立刻去结算</span><i></i>
            </div>
        </div>
    </div>
    <div class="navBox">
        <div>
            <div class="leftSidebar">
                <div class="leftSidebar_title">
                    全部商品分类 <i></i>
                    <ul>
                    </ul>
                </div>
            </div>
            <ul class="navMenu">
                <li><a href="main.html">主页</a></li>
                <li><a href="#">安心宅配</a></li>
                <li><a href="#">特色预定</a></li>
                <li><a href="#">卡卷总换</a></li>
                <li><a href="#">企业定制</a></li>
                <li><a href="#">活动专享</a></li>
                <li><a href="#">依谷资讯</a></li>
                <li><a href="#">依谷扶贫</a></li>
                <li><a href="#">依谷公益</a></li>
            </ul>
        </div>
        </div>
    <div class="main">
        <ul class="main_cart">
            <li class="main_cart_ti">
                <div><input type="checkbox" > 全选</div><div></div><span>单价</span><span>数量</span><span>合计</span><span>重量</span>
                <span>操作</span>
            </li>
        </ul>
        <div class="main_settlement">
            <div class="main_total">
                <div><p>商品总价</p><p class="alprice">￥127.80</p></div>
                <div><p>购买总数</p><p id="number">2</p></div>
            </div>
            <div class="main_doSettlement">
                <div>商品总价：</div>
                <div><p class="alprice">￥127.80</p><p>已节省: ￥21.9</p></div>
                <div><a href="#">去结算</a></div>
            </div>
        </div>
    </div>
    <div class="footer">
    <div class="footer_links">
        <ul>
            <li>
                <h3>基地直供 冷链直达</h3>
                <p>优选蔬果,从基地到餐桌全程冷链直达</p>
            </li>
            <li>
                <h3>同城快递 次日直达</h3>
                <p>当天16点前下单第二天送达（限深圳同城）</p>
            </li>
            <li>
                <h3>在线支付 灵活便利</h3>
                <p>多样化支付方式，更便捷 省时省心</p>
            </li>
            <li>
                <h3>退换无忧 服务保障</h3>
                <p>24小时退换货，流程通畅无阻省时省心</p>
            </li>
        </ul>
    </div>
    <div class="footer_menu">
        <ul>
            <ul>购物指南
                <a href="#"><li>会员注册</li></a>
                <a href="#"><li>套餐卡使用方法</li></a>
                <a href="#"><li>谷穗卡使用方法</li></a>
            </ul>
            <ul>付款方式
                <a href="#"><li>线上支付</li></a>
                <a href="#"><li>发票说明</li></a>
                <a href="#"><li>余额支付</li></a>
            </ul>
            <ul>商品配送
                <a href="#"><li>买家自取</li></a>
                <a href="#"><li>配送时间</li></a>
                <a href="#"><li>冷链配送</li></a>
                <a href="#"><li>送货范围及费用</li></a>
            </ul>
            <ul>售后服务
                <a href="#"><li>签收与评价</li></a>
                <a href="#"><li>常见问题</li></a>
                <a href="#"><li>退换货说明</li></a>
                <a href="#"><li>品质保障</li></a>
            </ul>
            <ul>求真依谷
                <a href="#"><li>慈善公益</li></a>
                <a href="#"><li>依谷资讯</li></a>
                <a href="#"><li>招贤纳士</li></a>
                <a href="#"><li>关于我们</li></a>
            </ul>
        </ul>
        <div class="footer_wx">
            <p>依谷微信</p>
            <img src="img/尾部/index-bottom-ygw-wx.jpg" alt="">
        </div>
    </div>
    <div class="footer_service">
        <p><span><a href="#">关于依谷</a></span><span><a href="#">加入依谷</a></span><span><a href="#">联系依谷</a></span><span><a
                href="#">免责声明</a></span><span><a href="#">依谷资讯</a></span><span><a href="#">网站地图</a></span><span><a
                href="#">客服在线</a></span>
        </p>
        <p><a href="#"><img src="img/尾部/dzswsfqy.png" alt="#"></a><a href="#"><img src="img/尾部/kxwz.jpg" alt=""></a><a
                href="#"><img src="img/尾部/xfwq.jpg" alt=""></a><a
                href="#"><img src="img/尾部/zmpp.jpg" alt=""></a><a href="#"><img src="img/尾部/spltxkz.png" alt=""></a><a
                href="#"><img src="img/尾部/govIcon.gif"alt=""></a>
        </p>
        <p>Copyright © 2010-2019 所有图片均受著作权保护，未经许可任何单位与个人不得使用、复制、转载、摘编，违者必究法律责任。
            <a href="#">粤ICP备19014370号-2</a> | All Rights Reserved 深圳依谷网版权所有 网络实名：<a href="#">依谷网</a></p>
    </div>
    </div>
</body>
<script src="js/方法封装.js"></script>
<script src="js/购物cookie.js"></script>
<script>
    //遍历并添加购物车
    xml("json/dataBase.json",function (t) { //上架物品
        var texts = JSON.parse(t.responseText);
        var number=0;
        var objs=allCookie();
        if (objs!=null){
            var arr=[];
            for (var i = 0; i < objs.length; i++) {
                arr[objs[i].on]=objs[i];
            }
            for (var i in arr) {
                addshop(texts[i].name,new Number(texts[i].price),arr[i].num,arr[i].on);
                number+=parseInt(arr[i].num);
            }
        }
        document.getElementById("number").innerHTML=number;
        toAlprice()
    });

    //遍历添加标签页
    var leftSidebar_title=document.getElementsByClassName("leftSidebar_title")[0].lastElementChild;
    xml("json/scratch.json",function (t) {
        //nav加载
        text=JSON.parse(t.responseText);
        var leftNavHtml="";
        var e=0;
        for (var i in text) {
        leftNavHtml+="<li><span style='background-position:"+-(e*31)+"px 0;'></span><a href='#'>"+i+"</a>";
            leftNavHtml+="<div>";
            var content=text[i].content;
            for (var contentKey in content) {
                leftNavHtml+="<dl><a href='#'><h3>"+contentKey+"</h3></a><ul>";
                for (var k = 0; k < content[contentKey].length; k++) {
                    leftNavHtml+="<li><a href='#'>"+content[contentKey][k]+"</a></li>"
                }
                leftNavHtml+="</ul></dl>";
            }
            leftNavHtml+="</div>"
            e>5?e=e:e++;
            leftNavHtml+="</li>";
        }
        leftSidebar_title.innerHTML=leftNavHtml;
    });


    /**
     *
     */
    var lis=document.getElementsByClassName("main_cart_con");
    var alprice=document.getElementsByClassName("alprice");
    function minus(Node) {       //减商品
        var price=Node.nextElementSibling;
        if(price.value===0){
            alert("不能再往下减了");
        }else{
            price.value-=1;
            changeCookie(Node.parentNode.parentNode.getAttribute("on"),price.value);
        }
        alPrice(Node.parentNode.parentNode);
    }

    function plus(Node) {        //加商品
        var price=Node.previousSibling;
        changeCookie(Node.parentNode.parentNode.getAttribute("on"),price.value);
        price.value=parseInt(price.value)+1;
        alPrice(Node.parentNode.parentNode);
    }
    function removecolmn(node) {     //删除
        removeshop(node.parentNode.parentNode.getAttribute("on"));
        node.parentNode.parentNode.parentNode.removeChild(node.parentNode.parentNode);
        toAlprice();
    }
    function alPrice(Node){      //该件商品总价
        var price=Node.children[3].children[1].value;
        changeCookie(Node.getAttribute("on"),Node.children[3].children[1].value);
        Node.children[4].innerHTML="¥"+(price*Node.children[2].innerHTML.substring(1)).toFixed(2);
        toAlprice();
    }
    function toAlprice() {      //商品总价
        var number=0;
        var price=0;
        for (var i = 0; i < lis.length; i++) {
            var p=lis[i].children[4].innerHTML.substr(1);
            price+=Number(p);
        }
        price=price.toFixed(2);
        alprice[0].innerHTML="¥"+price;
        alprice[1].innerHTML="¥"+price;
        var objs=allCookie();
        for (var i in objs) {
            number+=parseInt(objs[i].num);
        }
        document.getElementById("number").innerHTML=number;
    }
    document.getElementsByClassName("main_cart_ti")[0].getElementsByTagName("input")[0].onclick=function () {   //全选
        var click=document.getElementsByClassName("main_cart_con");
        for (var i = 0; i < click.length; i++) {
            click[i].getElementsByTagName("input")[0].checked=this.checked;
        }
    };
    function addshop(name, price, number,on) {//添加商品
        var li=document.createElement("li");
        li.setAttribute("class","main_cart_con");
        li.setAttribute("on",on);
        li.innerHTML="<div><input type='checkbox'></div>\n" +
                    "<div><img src='img/商品数据/"+on+"/cover.jpg'><a href='#'>"+name+"</a></div>" +
                    "<span>￥"+price+"</span><span><div class='main_cart_reduce' onclick='minus(this)'></div><input type='text' value='"+number+"' onblur='alPrice(this.parentNode.parentNode)'><div class='main_cart_add' onclick='plus(this)'></div></span><span>￥"+(price*number).toFixed(2)+"</span><span>336g</span>" +
                    "<span><p>移入收藏</p><p onclick='removecolmn(this)'>删除</p></span>";
        document.getElementsByClassName("main_cart")[0].appendChild(li);
    }
    /*
    购物车数量
     */
    document.getElementsByClassName("shopNum")[0].innerHTML=allNumber();
    document.getElementsByClassName("rightShop_shoppingPt2")[0].innerHTML=allNumber();
</script>
</html>